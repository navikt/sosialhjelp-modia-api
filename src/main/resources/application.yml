spring:
  main:
    banner-mode: 'off'
    allow-circular-references: true # bør endres
  application:
    name: "sosialhjelp-modia-api"
  redis:
    host: ${REDIS_HOST}
    port: 6379
    password: ${REDIS_PASSWORD}
  codec:
    max-in-memory-size: 10MB

modia:
  cache:
    time_to_live_seconds: ${CACHE_TIME_TO_LIVE_SECONDS:100}
  retry:
    fiks:
      attempts: 5 # number of attempts
      initial_delay: 250 # initial delay in ms
      max_delay: 10000 # max delay in ms

server:
  port: 8383
  servlet:
    context-path: '/sosialhjelp/modia-api'

# Prometheus
management:
  endpoints:
    web:
      base-path: "/internal"
      exposure:
        include: info, health, metrics, prometheus

springdoc:
  api-docs:
    enabled: ${SWAGGER_ENABLED}
  swagger-ui:
    path: swagger-ui.html
  pathsToMatch: /**/api/**

#Environment-variabler som settes av NAIS
client:
  abac_pdp_endpoint_url: ${ABAC_PDP_ENDPOINT_URL}
  fiks_digisos_endpoint_url: ${FIKS_DIGISOS_ENDPOINT_URL}
  fiks_integrasjonid: ${INTEGRASJONSID_FIKS}
  fiks_integrasjonpassord: ${INTEGRASJONPASSORD_FIKS}
  norg_endpoint_url: ${NORG_ENDPOINT_URL}
  norg_oppslag_url: ${NORG_OPPSLAG_URL:https://norg2-frontend.nais.adeo.no/#/startsok?enhetNr=}
  pdl_endpoint_url: ${PDL_ENDPOINT_URL}
  sts_token_endpoint_url: ${STS_TOKEN_ENDPOINT_URL}
  veileder_gruppe_id: ${VEILEDER_GRUPPE_ID}
  bergen_kommunenummer: ${BERGEN_KOMMUNENUMMER}
  stavanger_kommunenummer: ${STAVANGER_KOMMUNENUMMER}
  azure_token_endpoint_url: ${AZURE_OPENID_CONFIG_TOKEN_ENDPOINT}
  azuredings_jwt_audience: ${AZURE_OPENID_CONFIG_ISSUER:dummyAudience}
  azuredings_url: ${AZURE_APP_WELL_KNOWN_URL}
  azuredings_jwt_client_id: ${AZURE_APP_CLIENT_ID}
  azuredings_private_jwk: ${AZURE_APP_JWK}
  azure_client_id: ${AZURE_APP_CLIENT_ID}
  azure_client_secret: ${AZURE_APP_CLIENT_SECRET}
  azure_graph_url: ${AZURE_GRAPH_API_URL}
  skjermede_personer_scope: ${SKJERMEDE_PERSONER_SCOPE}
  skjermede_personer_endpoint_url: ${SKJERMEDE_PERSONER_ENDPOINT_URL}
  unleash_url: ${UNLEASH_API_URL}
  unleash_instance_id: ${UNLEASH_INSTANCE_ID}

#Maskinporten
maskinporten_clientid: ${MASKINPORTEN_CLIENT_ID}
maskinporten_scopes: ${MASKINPORTEN_SCOPES}
maskinporten_well_known_url: ${MASKINPORTEN_WELL_KNOWN_URL}
maskinporten_client_jwk: ${MASKINPORTEN_CLIENT_JWK}

#Token-validering
no.nav.security.jwt:
  issuer.azuread:
    discoveryurl: ${AZURE_APP_WELL_KNOWN_URL}
    accepted_audience: ${AZURE_APP_CLIENT_ID}, api://${AZURE_APP_CLIENT_ID}
  client:
    registration:
      onbehalfof:
        token-endpoint-url: https://login.microsoftonline.com/${AZURE_APP_TENANT_ID}/oauth2/v2.0/token
        grant-type: urn:ietf:params:oauth:grant-type:jwt-bearer
        scope: https://graph.microsoft.com/.default
        authentication:
          client-id: ${AZURE_APP_CLIENT_ID}
          client-secret: ${AZURE_APP_CLIENT_SECRET}
          client-auth-method: client_secret_basic

loginurl: ${LOGINURL:http://localhost:8383/sosialhjelp/modia-api/local/cookie} # TODO: må fikses når vi finner ut url i miljø.
